/* eslint-disable react-refresh/only-export-components */
import React, { createContext, useContext, useState, useEffect, useCallback } from 'react';

const translations = {
  es: {
    // Navigation
    'nav.playoffs': 'Playoffs',
    'nav.groups': 'Grupos',
    'nav.knockout': 'Eliminatorias',
    'nav.stats': 'Estad铆sticas',
    'nav.stream': 'Stream',
    'nav.calendar': 'Calendario',
    'nav.complete': 'Completo',
    // Header
    'header.title': 'World Cup',
    'header.year': '2026',
    'header.simulator': 'Simulador',
    // Playoffs
    'playoffs.title': 'Clasificaci贸n',
    'playoffs.subtitle': 'Selecciona los ganadores de cada ruta para completar los grupos',
    'playoffs.progress': 'Progreso',
    'playoffs.selected': 'seleccionados',
    'playoffs.allSelected': 'Todos los ganadores seleccionados. Ve a Grupos para iniciar.',
    'playoffs.pending': 'Pendiente',
    'playoffs.about': 'Sobre los Playoffs',
    'playoffs.uefaPaths': 'Rutas UEFA (A-D): Clasificatorios europeos compitiendo por 4 plazas',
    'playoffs.intercontinental': 'Intercontinental (1-2): Equipos de diferentes confederaciones por 2 plazas',
    'playoffs.selectOne': 'Selecciona un ganador de cada ruta para completar los 48 equipos',
    'playoffs.canChange': 'Puedes cambiar tus selecciones en cualquier momento',
    // Groups
    'groups.title': 'Fase de',
    'groups.titleHighlight': 'Grupos',
    'groups.subtitle': '12 grupos de 4 equipos. Los 2 primeros + 8 mejores terceros clasifican.',
    'groups.matchesPlayed': 'partidos jugados',
    'groups.difficulty.easy': 'F谩cil',
    'groups.difficulty.medium': 'Medio',
    'groups.difficulty.hard': 'Dif铆cil',
    'groups.difficulty.death': 'Muerte',
    'groups.qualified': 'Clasificado',
    'groups.possible': 'Posible clasificaci贸n',
    'groups.matches': 'Partidos',
    'groups.howItWorks': 'C贸mo funciona la fase de grupos',
    'groups.rule1': 'Cada equipo juega 3 partidos (uno contra cada otro equipo del grupo)',
    'groups.rule2': 'Victoria = 3 puntos, Empate = 1 punto, Derrota = 0 puntos',
    'groups.rule3': 'Se ordenan por: Puntos, Diferencia de goles, Goles a favor',
    'groups.rule4': 'Los 2 primeros de cada grupo clasifican autom谩ticamente',
    'groups.rule5': 'Los 8 mejores terceros tambi茅n clasifican',
    // Knockout
    'knockout.champion': 'CAMPEN DEL MUNDO',
    'knockout.r32': 'Dieciseisavos',
    'knockout.r16': 'Octavos',
    'knockout.qf': 'Cuartos',
    'knockout.sf': 'Semifinales',
    'knockout.final': 'Final',
    'knockout.3rdPlace': 'Tercer Puesto',
    'knockout.penalties': 'Seleccionar Ganador por Penales',
    'knockout.penaltyShootout': 'Tanda de Penales',
    'knockout.penaltyResult': 'Partido termin贸',
    'knockout.selectWinner': 'Selecciona el ganador:',
    'knockout.winsOnPenalties': 'Gana en penales',
    'knockout.waiting': 'Esperando...',
    'knockout.howItWorks': 'C贸mo funciona',
    'knockout.rule1': 'Ingresa los marcadores. Los ganadores avanzan autom谩ticamente.',
    'knockout.rule2': 'Si hay empate, selecciona el ganador por penales.',
    'knockout.rule3': 'Despl谩zate horizontalmente para ver todas las rondas.',
    // Stats
    'stats.title': 'Estad铆sticas del',
    'stats.titleHighlight': 'Torneo',
    'stats.subtitle': 'Progreso e informaci贸n en tiempo real',
    'stats.groupStage': 'Fase de Grupos',
    'stats.knockoutStage': 'Eliminatorias',
    'stats.totalGoals': 'Goles Totales',
    'stats.avgGoals': 'Promedio Goles/Partido',
    'stats.inAllMatches': 'En todos los partidos',
    'stats.goalsPerGame': 'Goles por juego',
    'stats.matches': 'partidos',
    'stats.progress': 'Progreso del Torneo',
    'stats.overall': 'General',
    'stats.topScoring': 'Equipos M谩s Goleadores',
    'stats.noGoals': 'No hay goles a煤n',
    'stats.startEntering': 'Comienza a ingresar resultados para ver estad铆sticas',
    'stats.finalStandings': 'Clasificaci贸n Final',
    'stats.upsets': 'Grandes Sorpresas',
    'stats.savedSimulations': 'Simulaciones Guardadas',
    'stats.beat': 'venci贸 a',
    // Save/Load
    'save.simulationName': 'Nombre de la Simulaci贸n',
    'save.save': 'Guardar',
    'save.export': 'Exportar JSON',
    'save.import': 'Importar',
    'save.reset': 'Reiniciar',
    'save.resetConfirm': '驴Est谩s seguro? Se borrar谩n todos los resultados y selecciones.',
    'save.yesReset': 'S铆, Reiniciar',
    'save.cancel': 'Cancelar',
    'save.saved': '隆Guardado!',
    'save.lastSaved': 'ltimo guardado:',
    'save.savedSimulations': 'Simulaciones Guardadas',
    // Stream
    'stream.title': 'Modo',
    'stream.titleHighlight': 'Streamer',
    'stream.subtitle': 'Herramientas y widgets para tu stream',
    // Calendar
    'calendar.title': 'Calendario de',
    'calendar.titleHighlight': 'Partidos',
    'calendar.subtitle': 'Fechas, horarios y sedes del torneo',
    'calendar.groupStage': 'Fase de Grupos',
    'calendar.knockout': 'Eliminatorias',
    'calendar.venue': 'Sede',
    // Auto-sim
    'autosim.title': 'Auto-Simulaci贸n',
    'autosim.description': 'Genera resultados autom谩ticos basados en ratings FIFA',
    'autosim.simulateAll': 'Simular Todo',
    'autosim.simulateGroups': 'Simular Grupos',
    'autosim.simulateKnockout': 'Simular Eliminatorias',
    'autosim.randomize': 'Aleatorio',
    // Share
    'share.title': 'Compartir Simulaci贸n',
    'share.copyLink': 'Copiar Enlace',
    'share.copied': '隆Copiado!',
    'share.qrCode': 'C贸digo QR',
    // Export
    'export.title': 'Exportar Resultados',
    'export.asPNG': 'Como Imagen',
    'export.asCSV': 'Como CSV',
    'export.asJSON': 'Como JSON',
    // Search
    'search.placeholder': 'Buscar equipo o grupo...',
    'search.noResults': 'Sin resultados',
    // Common
    'common.rank': 'Ranking',
    'common.team': 'Equipo',
    'common.points': 'Pts',
    'common.played': 'PJ',
    'common.won': 'PG',
    'common.drawn': 'PE',
    'common.lost': 'PP',
    'common.gd': 'DG',
    'common.gf': 'GF',
    'common.ga': 'GC',
    'common.close': 'Cerrar',
    'common.loading': 'Cargando...',
    // Achievements
    'achievements.title': 'Logros',
    'achievements.firstGoal': 'Primer Gol',
    'achievements.firstGoalDesc': 'Ingresa el primer resultado de un partido',
    'achievements.groupComplete': 'Grupo Completo',
    'achievements.groupCompleteDesc': 'Completa todos los partidos de un grupo',
    'achievements.allGroups': 'Todos los Grupos',
    'achievements.allGroupsDesc': 'Completa la fase de grupos completa',
    'achievements.champion': 'Campe贸n',
    'achievements.championDesc': 'Determina al campe贸n del mundo',
    'achievements.upset': 'Sorpresa',
    'achievements.upsetDesc': 'Registra una sorpresa en un partido',
    'achievements.simulator': 'Simulador',
    'achievements.simulatorDesc': 'Usa la auto-simulaci贸n',
    'achievements.shared': 'Compartido',
    'achievements.sharedDesc': 'Comparte tu simulaci贸n',
    'achievements.exported': 'Exportado',
    'achievements.exportedDesc': 'Exporta tus resultados',
    // Tutorial
    'tutorial.welcome': '隆Bienvenido al Simulador del Mundial 2026!',
    'tutorial.step1': 'Primero, selecciona los ganadores de los playoffs',
    'tutorial.step2': 'Luego ingresa los resultados de la fase de grupos',
    'tutorial.step3': 'Los equipos clasificados avanzan a las eliminatorias',
    'tutorial.step4': 'Ve las estad铆sticas y comparte tu simulaci贸n',
    'tutorial.gotIt': '隆Entendido!',
    'tutorial.next': 'Siguiente',
    'tutorial.prev': 'Anterior',
    'tutorial.skip': 'Omitir',
    // Keyboard shortcuts
    'shortcuts.title': 'Atajos de Teclado',
    'shortcuts.navigation': 'Navegaci贸n',
    'shortcuts.actions': 'Acciones',
    'shortcuts.toggleTheme': 'Cambiar Tema',
    'shortcuts.toggleLang': 'Cambiar Idioma',
    'shortcuts.search': 'Buscar',
    'shortcuts.save': 'Guardar',
    'shortcuts.help': 'Ayuda / Atajos',
    'shortcuts.autoSim': 'Auto-simular',
    'shortcuts.export': 'Exportar',
    // Footer
    'footer.title': 'World Cup 2026 Simulator',
    'footer.autoSave': 'Los datos se guardan autom谩ticamente en tu navegador',
  },
  en: {
    'nav.playoffs': 'Playoffs',
    'nav.groups': 'Groups',
    'nav.knockout': 'Knockout',
    'nav.stats': 'Stats',
    'nav.stream': 'Stream',
    'nav.calendar': 'Calendar',
    'nav.complete': 'Complete',
    'header.title': 'World Cup',
    'header.year': '2026',
    'header.simulator': 'Simulator',
    'playoffs.title': 'Qualifiers',
    'playoffs.subtitle': 'Select the winners from each playoff path to complete the groups',
    'playoffs.progress': 'Progress',
    'playoffs.selected': 'selected',
    'playoffs.allSelected': 'All playoff winners selected! Go to Groups to start.',
    'playoffs.pending': 'Pending',
    'playoffs.about': 'About Playoffs',
    'playoffs.uefaPaths': 'UEFA Paths (A-D): European playoff qualifiers competing for 4 spots',
    'playoffs.intercontinental': 'Intercontinental (1-2): Teams from different confederations for 2 spots',
    'playoffs.selectOne': 'Select one winner from each path to complete the 48-team lineup',
    'playoffs.canChange': 'You can change your selections at any time',
    'groups.title': 'Group',
    'groups.titleHighlight': 'Stage',
    'groups.subtitle': '12 groups of 4 teams. Top 2 + 8 best 3rd place teams qualify.',
    'groups.matchesPlayed': 'matches played',
    'groups.difficulty.easy': 'Easy',
    'groups.difficulty.medium': 'Medium',
    'groups.difficulty.hard': 'Hard',
    'groups.difficulty.death': 'Death',
    'groups.qualified': 'Qualified',
    'groups.possible': 'Possible qualification',
    'groups.matches': 'Matches',
    'groups.howItWorks': 'How Group Stage Works',
    'groups.rule1': 'Each team plays 3 matches (once against each other team)',
    'groups.rule2': 'Win = 3 points, Draw = 1 point, Loss = 0 points',
    'groups.rule3': 'Ranked by: Points, Goal Difference, Goals For',
    'groups.rule4': 'Top 2 teams from each group automatically qualify',
    'groups.rule5': 'The 8 best 3rd-place teams also qualify',
    'knockout.champion': 'WORLD CHAMPION',
    'knockout.r32': 'Round of 32',
    'knockout.r16': 'Round of 16',
    'knockout.qf': 'Quarter Finals',
    'knockout.sf': 'Semi Finals',
    'knockout.final': 'Final',
    'knockout.3rdPlace': '3rd Place Play-off',
    'knockout.penalties': 'Select Penalty Winner',
    'knockout.penaltyShootout': 'Penalty Shootout',
    'knockout.penaltyResult': 'Match ended',
    'knockout.selectWinner': 'Select the winner:',
    'knockout.winsOnPenalties': 'Wins on penalties',
    'knockout.waiting': 'Waiting...',
    'knockout.howItWorks': 'How it works',
    'knockout.rule1': 'Enter scores for each match. Winners automatically advance.',
    'knockout.rule2': 'If a match ends in a draw, select the penalty shootout winner.',
    'knockout.rule3': 'Scroll horizontally to see all rounds of the bracket.',
    'stats.title': 'Tournament',
    'stats.titleHighlight': 'Statistics',
    'stats.subtitle': 'Real-time progress and insights',
    'stats.groupStage': 'Group Stage',
    'stats.knockoutStage': 'Knockout Stage',
    'stats.totalGoals': 'Total Goals',
    'stats.avgGoals': 'Avg Goals/Match',
    'stats.inAllMatches': 'In all matches',
    'stats.goalsPerGame': 'Goals per game',
    'stats.matches': 'matches',
    'stats.progress': 'Tournament Progress',
    'stats.overall': 'Overall',
    'stats.topScoring': 'Top Scoring Teams',
    'stats.noGoals': 'No goals scored yet',
    'stats.startEntering': 'Start entering match results to see statistics',
    'stats.finalStandings': 'Final Standings',
    'stats.upsets': 'Major Upsets',
    'stats.savedSimulations': 'Saved Simulations',
    'stats.beat': 'beat',
    'save.simulationName': 'Simulation Name',
    'save.save': 'Save',
    'save.export': 'Export JSON',
    'save.import': 'Import',
    'save.reset': 'Reset',
    'save.resetConfirm': 'Are you sure? This will clear all match results and selections.',
    'save.yesReset': 'Yes, Reset',
    'save.cancel': 'Cancel',
    'save.saved': 'Saved!',
    'save.lastSaved': 'Last saved:',
    'save.savedSimulations': 'Saved Simulations',
    'stream.title': 'Streamer',
    'stream.titleHighlight': 'Mode',
    'stream.subtitle': 'Tools and widgets for your stream',
    'calendar.title': 'Match',
    'calendar.titleHighlight': 'Calendar',
    'calendar.subtitle': 'Tournament dates, times and venues',
    'calendar.groupStage': 'Group Stage',
    'calendar.knockout': 'Knockout',
    'calendar.venue': 'Venue',
    'autosim.title': 'Auto-Simulation',
    'autosim.description': 'Generate automatic results based on FIFA ratings',
    'autosim.simulateAll': 'Simulate All',
    'autosim.simulateGroups': 'Simulate Groups',
    'autosim.simulateKnockout': 'Simulate Knockout',
    'autosim.randomize': 'Randomize',
    'share.title': 'Share Simulation',
    'share.copyLink': 'Copy Link',
    'share.copied': 'Copied!',
    'share.qrCode': 'QR Code',
    'export.title': 'Export Results',
    'export.asPNG': 'As Image',
    'export.asCSV': 'As CSV',
    'export.asJSON': 'As JSON',
    'search.placeholder': 'Search team or group...',
    'search.noResults': 'No results',
    'common.rank': 'Rank',
    'common.team': 'Team',
    'common.points': 'Pts',
    'common.played': 'MP',
    'common.won': 'W',
    'common.drawn': 'D',
    'common.lost': 'L',
    'common.gd': 'GD',
    'common.gf': 'GF',
    'common.ga': 'GA',
    'common.close': 'Close',
    'common.loading': 'Loading...',
    'achievements.title': 'Achievements',
    'achievements.firstGoal': 'First Goal',
    'achievements.firstGoalDesc': 'Enter the first match result',
    'achievements.groupComplete': 'Group Complete',
    'achievements.groupCompleteDesc': 'Complete all matches in a group',
    'achievements.allGroups': 'All Groups',
    'achievements.allGroupsDesc': 'Complete the entire group stage',
    'achievements.champion': 'Champion',
    'achievements.championDesc': 'Determine the world champion',
    'achievements.upset': 'Upset',
    'achievements.upsetDesc': 'Record an upset in a match',
    'achievements.simulator': 'Simulator',
    'achievements.simulatorDesc': 'Use the auto-simulation',
    'achievements.shared': 'Shared',
    'achievements.sharedDesc': 'Share your simulation',
    'achievements.exported': 'Exported',
    'achievements.exportedDesc': 'Export your results',
    'tutorial.welcome': 'Welcome to the World Cup 2026 Simulator!',
    'tutorial.step1': 'First, select the playoff winners',
    'tutorial.step2': 'Then enter the group stage results',
    'tutorial.step3': 'Qualified teams advance to the knockout stage',
    'tutorial.step4': 'View statistics and share your simulation',
    'tutorial.gotIt': 'Got it!',
    'tutorial.next': 'Next',
    'tutorial.prev': 'Previous',
    'tutorial.skip': 'Skip',
    'shortcuts.title': 'Keyboard Shortcuts',
    'shortcuts.navigation': 'Navigation',
    'shortcuts.actions': 'Actions',
    'shortcuts.toggleTheme': 'Toggle Theme',
    'shortcuts.toggleLang': 'Toggle Language',
    'shortcuts.search': 'Search',
    'shortcuts.save': 'Save',
    'shortcuts.help': 'Help / Shortcuts',
    'shortcuts.autoSim': 'Auto-simulate',
    'shortcuts.export': 'Export',
    'footer.title': 'World Cup 2026 Simulator',
    'footer.autoSave': 'Data auto-saves to your browser',
  },
  pt: {
    'nav.playoffs': 'Playoffs',
    'nav.groups': 'Grupos',
    'nav.knockout': 'Eliminat贸rias',
    'nav.stats': 'Estat铆sticas',
    'nav.stream': 'Stream',
    'nav.calendar': 'Calend谩rio',
    'nav.complete': 'Completo',
    'header.title': 'Copa do',
    'header.year': 'Mundo 2026',
    'header.simulator': 'Simulador',
    'playoffs.title': 'Classifica莽茫o',
    'playoffs.subtitle': 'Selecione os vencedores de cada rota para completar os grupos',
    'groups.title': 'Fase de',
    'groups.titleHighlight': 'Grupos',
    'groups.subtitle': '12 grupos de 4 times. Top 2 + 8 melhores terceiros classificam.',
    'knockout.champion': 'CAMPEO DO MUNDO',
    'stats.title': 'Estat铆sticas do',
    'stats.titleHighlight': 'Torneio',
    'footer.title': 'Simulador Copa do Mundo 2026',
    'footer.autoSave': 'Dados salvos automaticamente no navegador',
  },
  fr: {
    'nav.playoffs': 'Barrages',
    'nav.groups': 'Groupes',
    'nav.knockout': 'liminatoires',
    'nav.stats': 'Stats',
    'nav.stream': 'Stream',
    'nav.calendar': 'Calendrier',
    'nav.complete': 'Termin茅',
    'header.title': 'Coupe du',
    'header.year': 'Monde 2026',
    'header.simulator': 'Simulateur',
    'playoffs.title': 'Qualifications',
    'playoffs.subtitle': 'S茅lectionnez les gagnants pour compl茅ter les groupes',
    'groups.title': 'Phase de',
    'groups.titleHighlight': 'Groupes',
    'groups.subtitle': '12 groupes de 4 茅quipes. Top 2 + 8 meilleurs 3e se qualifient.',
    'knockout.champion': 'CHAMPION DU MONDE',
    'stats.title': 'Statistiques du',
    'stats.titleHighlight': 'Tournoi',
    'footer.title': 'Simulateur Coupe du Monde 2026',
    'footer.autoSave': 'Donn茅es sauvegard茅es automatiquement',
  },
};

const I18nContext = createContext(null);

export function I18nProvider({ children }) {
  const [lang, setLang] = useState(() => {
    try {
      return localStorage.getItem('wc2026_lang') || 'es';
    } catch { return 'es'; }
  });

  useEffect(() => {
    localStorage.setItem('wc2026_lang', lang);
    document.documentElement.lang = lang;
  }, [lang]);

  const t = useCallback((key) => {
    return translations[lang]?.[key] || translations.en?.[key] || translations.es?.[key] || key;
  }, [lang]);

  const cycleLang = () => {
    const langs = Object.keys(translations);
    const next = langs[(langs.indexOf(lang) + 1) % langs.length];
    setLang(next);
  };

  const availableLanguages = Object.keys(translations).map(id => ({
    id,
    label: { es: 'Espa帽ol', en: 'English', pt: 'Portugu锚s', fr: 'Fran莽ais' }[id],
    flag: { es: '', en: '', pt: 'ю', fr: '' }[id],
  }));

  return (
    <I18nContext.Provider value={{ lang, setLang, t, cycleLang, availableLanguages }}>
      {children}
    </I18nContext.Provider>
  );
}

export function useI18n() {
  const ctx = useContext(I18nContext);
  if (!ctx) throw new Error('useI18n must be used within I18nProvider');
  return ctx;
}
